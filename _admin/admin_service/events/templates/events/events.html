{% extends "base.html" %}
{% set page_title = _('Events DB') %}

{% block content %}
<h1>{{ _("Events") }}</h1>

<div class="flakes-message">
    <b>Search Query Examples</b><br>
    <ol>
        <li>(when_start>="2015-10-31") and (when_start<="2015-11-01")</li>
        <li>special==True</li>
    </ol>
    Fields available: <i>title, agenda, social, image_url, level, place, when_start, when_end, only_date, registration_url, special</i>
</div>
<div class="flakes-search">
    <form method="get" id="search">
        <input class="search-box search" placeholder="Search Events" autofocus name="query">
    </form>
</div>
<div class="flakes-actions-bar">
    <button type="submit" form="search"
            class="action button-gray smaller">Search</button>
    <button type="submit" name="submit" form="events_list"
            class="action button-red smaller right" value="delete">Delete events</button>
    <a class="action button-gray smaller right" href="{{ url_for('events.create_event') }}">Add event</a>

    <!--<a class="action button-gray smaller" href="">Delete</a>-->
</div>

<form id="events_list" method="post">
    <table class="flakes-table">
        <colgroup>
            <col span="1" style="width:20px" />
        </colgroup>
        <thead>
            <tr>
                <td><input type="checkbox"></td>
                <td class="name">Title</td>
                <td>When</td>
                <td>Last edited by</td>
            </tr>
        </thead>
        <tbody class="list">
            {% for event in events_data.events %}
                <tr>
                    <td><input type="checkbox" name="{{ event.id }}"></td>
                    <td><a href="{{ url_for('events.events_details', id_=event.id) }}">{{ event.title }}</a></td>
                    <td>
                      {% if event.include_time %}
                        {{ event.when_start|strfdatetime }}
                      {% else %}
                        {{ event.when_start|strfdate }}
                      {% endif %}
                    </td>
                    <td>{{ event.metainfo.creator }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    <input name=_csrf_token type=hidden value="{{ csrf_token() }}">
</form>
<div class="flakes-actions-bar">
    pages
    {% if offset > 0 %}
        <a href="{{ url_for('events.events_list') }}?offset=0&count={{ count }}">&Lt;</a>
        <a href="{{ url_for('events.events_list') }}?offset={{ offset - count }}&count={{ count }}">&lt; {{ page-1 }}</a>
    {% endif %}
    <a href="{{ url_for('events.events_list') }}?offset={{ offset }}&count={{ count }}">{{page}}</a>
    {% if events_data.has_next %}
        <a href="{{ url_for('events.events_list') }}?offset={{ offset + count }}&count={{ count }}">{{ page + 1 }} &gt;</a>
    {% endif %}
</div>
{% endblock %}
